@using ReSale.Web.Pages.Auth
@inject AuthenticationStateProvider AuthenticationStateProvider

<CascadingAuthenticationState>
    <Router AppAssembly="@typeof(App).Assembly">
        <Found Context="routeData">
            <AuthorizeView>
                <Authorized>
                    <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)"/>
                    <FocusOnNavigate RouteData="@routeData" Selector="h1"/>
                </Authorized>
                <NotAuthorized>
                    @if (routeData.PageType != typeof(Login)
                         && routeData.PageType != typeof(Verify)
                         && routeData.PageType != typeof(Reset)
                         && routeData.PageType != typeof(Register)
                         && routeData.PageType != typeof(Forgot))
                    {
                        <RedirectToLogin />
                    }
                    
                    @if (routeData.PageType == typeof(Login)
                         || routeData.PageType == typeof(Verify)
                         || routeData.PageType == typeof(Reset)
                         || routeData.PageType == typeof(Register)
                         || routeData.PageType == typeof(Forgot))
                    {
                        <RouteView RouteData="@routeData" DefaultLayout="@typeof(EmptyLayout)"/>
                    }
                </NotAuthorized>
            </AuthorizeView>
        </Found>
        
        <NotFound>
            <PageTitle>Not found</PageTitle>
            <LayoutView Layout="@typeof(EmptyLayout)">
                <div class="flex items-center justify-center">
                    <div class="mt-40">
                        <div class="text-center">
                            <h1 class="text-8xl font-bold text-red-primary">404</h1>
                            <h2 class="text-6xl font-bold text-red-primary">Page Not Found</h2>
                            <p class="text-4xl mt-8 text-light-gray">It's okay to panic!</p>
                            <p class="text-sm mt-4 text-light-gray">This page is still under construction by our trained AI.</p>
                            <a href="/" class="mt-6 inline-block text-blue-primary hover:text-blue-secondary">
                                <div class="flex">
                                    <i class="fas fa-arrow-left mt-1 mr-2"></i>
                                    <p>Back to home</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </LayoutView>
        </NotFound>
    </Router>
</CascadingAuthenticationState>

@code {
    protected override async Task OnInitializedAsync()
    {
        await AuthenticationStateProvider.GetAuthenticationStateAsync();
    }
}